# 08. Visualización de gráficas

## 8.1. Gráficos básicos de streamlit

- `st.bar_chart()`: Gráfico de barras.
- `st.line_chart()`: Gráfico de línea.
- `st.area_chart()`: Gráfico de línea rellenado
- `st.scatter_chart()`: Gráfico de dispersión.
- `st.map()`: Construye un mapa
- Código

    ```python
    # Código en Gráficas/graficas_1.py
    import streamlit as st
    import pandas as pd
    import numpy as np
    import plotly.graph_objects as go
    
    st.divider()
    # Bar chart
    st.write('Gráfico de barras `st.bar_chart(df, x="Categorías", y="Valores")`')
    bar_data = {'Categorías': ['A', 'B', 'C'], 
                'Valores': [10, 20, 30]}
    df = pd.DataFrame(bar_data)
    st.bar_chart(df, x="Categorías", y="Valores")
    
    st.divider()
    # Line chart
    st.write('Gráfico de línes `st.line_chart(line_data.set_index("Date"))`')
    line_data = pd.DataFrame({'Date': pd.date_range(start='1/1/2020', periods=30), 
                              'Value': np.random.randn(30).cumsum()})
    st.line_chart(line_data.set_index('Date'))
    
    st.divider()
    # Area chart
    st.write('Gráfico de área `st.area_chart(area_data.set_index("Time"))`')
    area_data = pd.DataFrame({'Time': range(1, 11), 
                              'Value': np.random.randn(10).cumsum()})
    st.area_chart(area_data.set_index('Time'))
    
    st.divider()
    # Scatter chart
    st.write('Gráfico de dispersión `st.scatter_chart(data)`')
    data = pd.DataFrame(np.random.randn(100, 2), columns= ['A', 'B'])
    st.scatter_chart(data)
    
    st.divider()
    # Mapa
    st.write('Mapa `st.map(data)`')
    data = pd.DataFrame({'lat': [43.26093, 43.296782], 'lon': [-2.93611, -1.895542]})
    st.map(data)
    
    st.divider()
    # Gráfico de línea con Plotly
    st.write('Gráfico de línea con Plotly')
    x = np.linspace(0, 2 * np.pi, 100)
    y = np.sin(x)
    
    fig = go.Figure()
    fig.add_trace(go.Scatter(x=x, y=y, mode='lines', name='Sine wave'))
    fig.update_layout(title='Gráfico del seno(x) con Plotly',
                    xaxis_title='x',
                    yaxis_title='sin(x)')
    
    st.plotly_chart(fig)
    ```

### 8.2. Métricas (tarjetas)

Sirven para representar valores resultantes de un cálculo, de resumen de datos o el contenido de variables en una tarjeta

```python
import streamlit as st
col1, col2, col3 , col4= st.columns(4)

col1.metric("Temperature", "26 °C", "1.2 °F")
col2.metric("Wind", "20 mph", "-8%")
col3.metric("Humidity", "16%", "4%")
col4.metric("Rain", "6%", "10%")
```

### 8.3. Widgets estéticos y de visualización optimizados

Sirven para que la aplicación de datos sea más intuitiva, informativa y atractiva.

Widgets que ayudan a mostrar métricas, realizar un seguimiento del progreso, indicar el estado e incorporar elementos multimedia.

Mostrar widgets de progreso y estado

Estos widgets ayudan a mantener a los usuarios informados sobre la finalización de la tarea o el progreso del proceso en segundo plano. Estos widgets te permiten agregar animación a tu aplicación. Los widgets incluyen:

- `st.progress`: este widget muestra una barra de progreso en su aplicación Streamlit, que es útil para visualizar el progreso de una operación de larga duración. Es útil para proporcionar a los usuarios comentarios sobre qué parte de la tarea se ha completado.
- `st.spinner`: este widget muestra un control giratorio de carga mientras se ejecuta una operación específica o un bloque de código. Es una forma práctica de indicar a los usuarios que la aplicación está procesando algo en segundo plano.
- `st.status`: este widget se utiliza para mostrar el estado de operaciones o tareas en curso, generalmente en forma de notificaciones o alertas. Este widget ayuda a los usuarios a mantenerse informados sobre el estado actual de las tareas, ya sea que estén en progreso, completadas o hayan encontrado errores.
- `st.ballons`: este widget agrega un toque de celebración a su aplicación Streamlit al activar una animación de globos flotando en la pantalla. Este widget es perfecto para marcar la finalización de una tarea como un logro importante.
- `st.snow`: este widget crea un efecto de nevada dentro de tu aplicación Streamlit, añadiendo un ambiente festivo. Es una buena manera de darle alegría estacional a su aplicación o simplemente crear una experiencia de usuario más atractiva y visualmente atractiva.
- Código de procesos.py

    ```python
    import streamlit as st
    import time
    
    # Título de la aplicación
    st.title("Ejemplo de Widgets en Streamlit")
    
    # Botón para mostrar una barra de progreso
    if st.button("Mostrar Barra de Progreso"):
        progress_bar = st.progress(0)  # Inicializa la barra de progreso en 0%
        for i in range(100):
            time.sleep(0.05)  # Simula una tarea que toma tiempo
            progress_bar.progress(i + 1)  # Actualiza la barra de progreso
        st.success("¡Progreso completado!")
    
    # Botón para mostrar un spinner de carga
    if st.button("Mostrar Spinner de Carga"):
        with st.spinner("Procesando..."):
            time.sleep(3)  # Simula una tarea que toma tiempo
        st.success("¡Procesamiento completado!")
    
    # Botón para mostrar un estado de operación
    if st.button("Mostrar Estado de Operación"):
        with st.status("Tarea en progreso...", state="running") as status:
            time.sleep(2)  # Simula una tarea en progreso
            status.update(label="Tarea completada", state="complete")
        st.success("¡Estado actualizado!")
    
    # Botón para mostrar globos de celebración
    if st.button("Mostrar Globos de Celebración"):
        st.balloons()
        st.success("¡Celebremos este logro!")
    
    # Botón para mostrar efecto de nieve
    if st.button("Mostrar Efecto de Nieve"):
        st.snow()
        st.success("¡Es hora de festejar con nieve!")
    
    ```

### 8.4. Mostrar mensajes en la aplicación

Estos widgets ayudan a mostrar mensajes, que generalmente son el resultado de acciones realizadas durante la actividad del usuario. La mayoría de las veces, estos mensajes van precedidos de actividad de progreso y estado. Estos widgets incluyen:

- El siguiente fragmento de código demuestra el uso del widget de mensaje para mostrar:

    ```python
    # código en mensajes.py
    import streamlit as st
    import time
    
    # Título de la aplicación
    st.title("Ejemplo de Mensajes en Streamlit")
    
    # Botones para mostrar los diferentes mensajes
    if st.button("Mostrar Mensaje de Error"):
        st.error('Este es un mensaje de error')
    
    if st.button("Mostrar Mensaje de Advertencia"):
        st.warning('Este es un mensaje de advertencia')
    
    if st.button("Mostrar Mensaje Informativo"):
        st.info('Este es un mensaje informativo')
    
    if st.button("Mostrar Mensaje de Éxito"):
        st.success('Este es un mensaje de éxito')
    
    if st.button("Mostrar Excepción"):
        st.exception('Ha ocurrido una excepción')
    
    if st.button("Mostrar Toast"):
        st.toast('Mensaje que aparece y desaparece')
        time.sleep(2)  # Espera 2 segundos para que el toast desaparezca
    ```

### 8.5. Aplicaciones de chat

El típico chatbot

Los widgets de chat de Streamlit ofrecen una forma única e interactiva de interactuar con los usuarios en una interfaz conversacional dentro de sus aplicaciones web. Estos widgets tienen el potencial de crear aplicaciones complejas, como chatbots impulsados por modelos de lenguaje grandes (LLM). Para demostrar su destreza, nos centraremos en la creación de una aplicación de chat simple que proporcione citas aleatorias en respuesta a la entrada del usuario. Para ello, utilizaremos un conjunto de datos en línea de citas y lo integraremos en nuestra aplicación de chat.

```python
import streamlit as st
import requests

# Función que pide a una API una cita de un famoso.
def pide_una_cita():
    response = requests.get('https://api.quotable.io/random')
    if response.status_code == 200:
        data = response.json()
        return f"{data['content']} - {data['author']}"
    else:
        return "La API no ha funcionado."

# Interfaz del chat con Streamlit
st.title("Chatbot de citas aleatorias")
user_input = st.chat_input("Envía un mensaje al chatbot")
if user_input:
    with st.chat_message('user'):
        st.write(user_input)
    with st.chat_message('assistant'):
        st.write(pide_una_cita())
```
